server:
  port: 8080

spring:
  application:
    name: api-gateway

  cloud:
    gateway:
      # Spring Cloud Gateway 5.x (Spring Cloud 2025.x) uses the
      # `spring.cloud.gateway.server.webflux.*` prefix for WebFlux Gateway configuration.
      server:
        webflux:
          default-filters:
            - PreserveHostHeader

          routes:
            # AUTH -> /api/auth/**  ==>  auth-service /api/auth/**
            - id: auth
              uri: ${AUTH_SERVICE_URL:http://auth-service:8081}
              predicates:
                - Path=/api/auth/**

            # USERS -> /api/users/** ==> user-service /api/users/**
            - id: users
              uri: ${USER_SERVICE_URL:http://user-service:8082}
              predicates:
                - Path=/api/users/**

            # FRONTEND - EN SON
            - id: frontend
              uri: ${WEBAPP_URL:http://vidops-frontend:80}
              predicates:
                - Path=/**

          globalcors:
            cors-configurations:
              '[/**]':
                allowed-origins:
                  - "http://localhost:8080"
                  - "http://localhost:8090"
                  - "http://localhost"
                allowed-methods:
                  - GET
                  - POST
                  - PUT
                  - PATCH
                  - DELETE
                  - OPTIONS
                allowed-headers: "*"
                allow-credentials: true

management:
  endpoints:
    web:
      exposure:
        include: health,info
